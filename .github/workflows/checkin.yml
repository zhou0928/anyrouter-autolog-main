name: AnyRouter 自动签到
on:
  schedule:
    - cron: '0 */6 * * *'
  workflow_dispatch:

jobs:
  checkin:
    runs-on: self-hosted
    env:
      PYTHONIOENCODING: utf-8
    steps:
    - uses: actions/checkout@v4

    - name: 检查 Python 环境
      run: |
        python3 --version
        which python3

    - name: 检查依赖
      run: |
        python3 -c "import httpx; print('httpx:', httpx.__version__)"
        python3 -c "import playwright; print('playwright:', playwright.__version__)"
        python3 -c "import dotenv; print('python-dotenv: OK')"

    - name: 执行签到
      run: |
        python3 checkin.py

    - name: 执行结果
      if: always()
      run: |
        echo "签到任务执行完成"
        echo "时间: $(date)"
